<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>首页</title>
    <meta name="viewport" content="width=800,user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="海报首页">  
</head>
<body>

    <input id="sendInput" type="text"/> 
    <button id="sendBtn" onclick="sendMsg()">发送</button>
    <script>
        var ws = new WebSocket('ws://localhost:8087');
        ws.onopen = function(){
            ping();
        }

        ws.onmessage = function(ev) {
            console.log("get msg: " + ev.data)
            ping()
        }

        function ping(v) {
            lastmsg = +new Date();
            ws.send('msg:'+v+ lastmsg);
        }

        function sendMsg() {
            var value = document.getElementById('sendInput').value;
            console.log(value);
            if (!!value.trim()) {
                ping(value)
            }
            
            document.getElementById('sendInput').value = ''
        }
    </script>
</body>
</html>
